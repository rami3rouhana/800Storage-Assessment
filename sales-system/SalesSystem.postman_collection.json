{
  "info": {
    "_postman_id": "aa11bb22-cc33-dd44-ee55-ff6677889900",
    "name": "SalesSystem (All-in-One)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Sales system API collection covering Products, Clients, Sales, and Logs. All variables included inside the collection."
  },
  "item": [
    {
      "name": "Products Management",
      "item": [
        {
          "name": "Fetch Products",
          "request": { "method": "GET", "url": "{{base_url}}/api/products" }
        },
        {
          "name": "Create Product",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/products",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Laptop\",\n  \"description\": \"i7/16GB\",\n  \"category\": \"Electronics\"\n}"
            }
          },
          "event": [{
            "listen": "test",
            "script": { "exec": [
              "const id = pm.response.json().id;",
              "pm.collectionVariables.set('productId', id);"
            ]}
          }]
        },
        {
          "name": "Update Existing Product",
          "request": {
            "method": "PUT",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/products/{{productId}}",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Laptop Pro\",\n  \"description\": \"i7/32GB\",\n  \"category\": \"Electronics\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Clients Management",
      "item": [
        {
          "name": "Fetch Clients",
          "request": { "method": "GET", "url": "{{base_url}}/api/clients" }
        },
        {
          "name": "Create Client",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/clients",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"Ramy\",\n  \"lastName\": \"Test\",\n  \"mobile\": \"123123\"\n}"
            }
          },
          "event": [{
            "listen": "test",
            "script": { "exec": [
              "const id = pm.response.json().id;",
              "pm.collectionVariables.set('clientId', id);"
            ]}
          }]
        },
        {
          "name": "Update Existing Client",
          "request": {
            "method": "PUT",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/clients/{{clientId}}",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"Ramy\",\n  \"lastName\": \"Tester\",\n  \"mobile\": \"123123\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Sales Operations",
      "item": [
        {
          "name": "Fetch All Sales",
          "request": { "method": "GET", "url": "{{base_url}}/api/sales" }
        },
        {
          "name": "Create Sale (multiple transactions)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/sales",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"clientId\": {{clientId}},\n  \"seller\": \"RamyT\",\n  \"transactions\": [\n    { \"productId\": {{productId}}, \"quantity\": 2, \"price\": 120 },\n    { \"productId\": {{productId}}, \"quantity\": 1, \"price\": 40 }\n  ]\n}"
            }
          },
          "event": [{
            "listen": "test",
            "script": { "exec": [
              "const sale = pm.response.json();",
              "pm.collectionVariables.set('saleId', sale.id);",
              "if (sale.transactions && sale.transactions.length) {",
              "  pm.collectionVariables.set('transactionId1', sale.transactions[0].id);",
              "}"
            ]}
          }]
        },
        {
          "name": "Update Sale (quantities & prices)",
          "request": {
            "method": "PUT",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/sales/{{saleId}}",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"transactions\": [\n    { \"id\": {{transactionId1}}, \"quantity\": 5, \"price\": 150 }\n  ]\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Logging",
      "item": [
        {
          "name": "Fetch Sale Logs",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/api/sales/{{saleId}}/logs"
          }
        }
      ]
    }
  ],
  "variable": [
    { "key": "base_url", "value": "http://localhost:8081" },
    { "key": "productId", "value": "" },
    { "key": "clientId", "value": "" },
    { "key": "saleId", "value": "" },
    { "key": "transactionId1", "value": "" }
  ]
}
